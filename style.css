/* ===== 앱 화면 통짜 스케일 패치 (글로벌, 변경 없음) ===== */
:root{ --design-w: 390; --design-h: 844; }
html, body { margin:0; padding:0; height:100%; }
html { -webkit-text-size-adjust:100%; }
body { background:#fff; overflow:hidden; }

.app-scale{
  position: fixed;
  inset: env(safe-area-inset-top,0) env(safe-area-inset-right,0)
         env(safe-area-inset-bottom,0) env(safe-area-inset-left,0);
  display:flex; align-items:center; justify-content:center;
}
.app-viewport{
  width: calc(var(--design-w) * 1px);
  height: calc(var(--design-h) * 1px);
  transform-origin: top left;
  --scale-x: calc(100dvw / (var(--design-w) * 1px));
  --scale-y: calc(100dvh / (var(--design-h) * 1px));
  --scale: min(var(--scale-x), var(--scale-y));
  transform: scale(var(--scale));
  overflow:auto;
  overscroll-behavior: contain;
  padding-top: env(safe-area-inset-top,0);
  padding-bottom: env(safe-area-inset-bottom,0);
}
/* 필요하면 좌상단 정렬:
.app-scale{ align-items:flex-start; justify-content:flex-start; } */

/* Pretendard */
@import url("https://cdn.jsdelivr.net/npm/pretendard/dist/web/static/pretendard.css");

/* =========================
   PLANEAT THEME (Scoped)
   모든 규칙은 .planeat-skin 하위에만 적용됨
   ========================= */
.planeat-skin{
  /* ---------- Theme Presets ---------- */
  --bg:#f6f3ef; --panel:#ffffffcc;
  --text:#1e1b18; --muted:#8c867f; --line:#e9e2d9;
  --brand:#1f1e1c; --accent:#222; --accent-2:#b27a3b;
  --chip:#f3eee7; --chip-text:#3f3a34;

  --radius:16px; --radius-sm:12px;
  --shadow:0 12px 30px rgba(0,0,0,.08);
  --soft:0 8px 20px rgba(0,0,0,.06);
  --blur:12px;

  --focus-ring:0 0 0 3px rgba(178,122,59,.18);
  --today-outline:2px solid rgba(178,122,59,.22);

  --now:#2b6af3; --grid:#ece6dd;

  /* 레오파드 포인트 토글 */
  --leo:false;

  /* Base */
  color:var(--text);
  background:
    radial-gradient(900px 420px at 15% -10%, rgba(178,122,59,.10), transparent 60%),
    radial-gradient(1000px 520px at 100% -10%, rgba(0,0,0,.06), transparent 60%),
    var(--bg);
  font-family:"Pretendard",system-ui,-apple-system,"Segoe UI",Roboto,Arial,sans-serif;
}

.planeat-skin *{ box-sizing:border-box }

/* 컨테이너(글래스) */
.planeat-skin .calendar-container{
  max-width: 980px; margin: 64px auto; padding: 24px;
  background: var(--panel);
  border: 1px solid var(--line);
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  backdrop-filter: blur(var(--blur));
}

/* 헤더 */
.planeat-skin .calendar-header{
  display:flex; align-items:center; justify-content:space-between; margin-bottom:6px;
}
.planeat-skin #currentMonthYear{
  margin:0; line-height:1.1; letter-spacing:-.02em;
  font-size: clamp(24px, 2.8vw, 32px); font-weight: 900;
  background: linear-gradient(90deg,var(--brand),var(--accent-2));
  -webkit-background-clip:text; background-clip:text; color:transparent;
}

/* 컨트롤 */
.planeat-skin .calendar-controls{ display:flex; align-items:center; gap:10px; flex-wrap:wrap; margin-top:10px }
.planeat-skin .calendar-controls button{
  appearance:none; border:1px solid var(--line); background:#fff;
  height:36px; padding:0 12px; border-radius:12px; font-weight:800; letter-spacing:-.01em;
  transition: transform .08s ease, box-shadow .2s ease, border-color .2s ease, background .2s ease;
}
.planeat-skin .calendar-controls button:hover{ transform:translateY(-1px); box-shadow: var(--soft) }
.planeat-skin .calendar-controls button.active{
  background: linear-gradient(180deg, var(--accent), #000);
  color:#fff; border-color:#000;
}
.planeat-skin #todayBtn{ font-weight:900 }
.planeat-skin #prevMonth,.planeat-skin #nextMonth{ width:36px; padding:0; border-radius:10px }

/* 검색 */
.planeat-skin .search-wrap{ margin-left:auto; display:flex; gap:8px; align-items:center }
.planeat-skin .search-btn{
  width:36px;height:36px;border-radius:10px;border:1px solid var(--line);background:#fff;
  display:grid; place-items:center; font-size:16px;
}
.planeat-skin .search-inputbox{ position:relative }
.planeat-skin #searchInput{
  width:260px; height:36px; border:1px solid var(--line); border-radius:12px; padding:0 12px;
  background:#fff; outline:none; transition: box-shadow .2s, border-color .2s;
}
.planeat-skin #searchInput:focus{ box-shadow:var(--focus-ring); border-color:var(--accent-2) }
.planeat-skin #searchPanel{
  position:absolute; left:0; right:0; top:calc(100% + 8px); display:none;
  background:#fff; border:1px solid var(--line); border-radius:14px; box-shadow:var(--shadow);
  padding:10px; max-height:320px; overflow:auto; z-index:30;
}
.planeat-skin #searchPanel[aria-hidden="false"]{ display:block }
.planeat-skin #searchPanel .sr-item{
  display:flex; justify-content:space-between; align-items:center;
  padding:10px 12px; border:1px solid var(--line); border-radius:12px; background:#fff;
  font-weight:800; cursor:pointer; transition:transform .06s ease, background .2s;
}
.planeat-skin #searchPanel .sr-item + .sr-item{ margin-top:6px }
.planeat-skin #searchPanel .sr-item:hover{ transform:translateY(-1px); background:#faf8f6 }
.planeat-skin #searchPanel .muted{ color:var(--muted) }

/* 주차 페이저 */
.planeat-skin #weekOptions{ display:flex; gap:8px; flex-wrap:wrap; margin:14px 0 8px }
.planeat-skin #weekOptions .week-item{
  padding:6px 12px; border:1px solid var(--line); border-radius:999px; background:#fff; font-weight:900;
}
.planeat-skin #weekOptions .week-item.selected{ background:#000; color:#fff; border-color:#000 }

/* 그리드 */
.planeat-skin #calendarGrid{
  display:grid; grid-template-columns:repeat(7,minmax(0,1fr)); gap:10px; margin-top:10px;
}
.planeat-skin .day-name{ text-align:center; font-weight:900; color:var(--muted); padding:8px 0 }
.planeat-skin .current-month{
  position:relative; background:#fff; border:1px solid var(--line);
  border-radius:14px; min-height:128px; padding:12px; box-shadow:var(--soft); overflow:hidden;
  transition: transform .08s ease, box-shadow .2s ease, border-color .2s ease;
}
.planeat-skin .current-month:hover{ transform:translateY(-1px); box-shadow:var(--shadow) }
.planeat-skin .current-month.today{ outline: var(--today-outline) }
.planeat-skin .date-number{ font-weight:900; font-size:13px; color:var(--muted) }

/* 사진 오버레이 (투명도 금지 & 레이어 고정) */
.planeat-skin .current-month.has-photo{ color:#fff; position:relative; overflow:hidden; }
.planeat-skin .day-bg-underlay,
.planeat-skin .day-bg-img{
  position:absolute !important; inset:0 !important; width:100% !important; height:100% !important;
  object-fit:cover !important; z-index:0 !important; opacity:1 !important;
  filter:none !important; mix-blend-mode:normal !important; pointer-events:none !important;
}
.planeat-skin .current-month > *:not(img){ position:relative; z-index:1 }

/* Day cell chips */
.planeat-skin .day-list{ margin-top:10px; display:flex; flex-direction:column; gap:6px }
.planeat-skin .dl-row{ display:flex; gap:6px; overflow:hidden }
.planeat-skin .dl-names{ display:flex; gap:6px; overflow:hidden }
.planeat-skin .dl-item{
  display:inline-flex; align-items:center; gap:6px; white-space:nowrap;
  background:var(--chip); color:var(--chip-text);
  border:1px solid var(--line); border-radius:999px; padding:4px 10px;
  font-size:12px; font-weight:900; letter-spacing:-.01em;
  transition: background .2s ease, border-color .2s ease;
}
.planeat-skin .dl-item.uncat{ background:#fff }
.planeat-skin .dl-label.uncat-chip{ color:var(--text) }
.planeat-skin .dl-bar-text{ font-weight:900; }
.planeat-skin .dl-bar-text[data-cat="meal"]{ color:var(--accent-2) }
.planeat-skin .dl-bar-text[data-cat="cafe"]{ color:#6aa382 }

/* 레오파드 칩 포인트 */
@supports (background: paint(worklet)){
  .planeat-skin[style*="--leo:true"] .dl-item:not(.uncat){
    background:
      radial-gradient(8px 6px at 10% 30%, rgba(0,0,0,.08), transparent 60%),
      radial-gradient(10px 7px at 35% 70%, rgba(0,0,0,.08), transparent 60%),
      var(--chip);
  }
}

/* 모달 */
.planeat-skin #eventModal{ position:fixed; inset:0; display:none; place-items:center; background:rgba(0,0,0,.28); z-index:100 }
.planeat-skin #eventModal[aria-hidden="false"]{ display:grid }
.planeat-skin #eventModal .modal-content{
  width:min(900px,94vw); max-height:86vh; overflow:auto;
  background: var(--panel); border:1px solid var(--line); border-radius:18px; box-shadow:var(--shadow);
  backdrop-filter: blur(var(--blur)); padding:18px;
}

/* 저장 카드/투두 */
.planeat-skin .saved-memo-item{ position:relative; border:1px solid var(--line); border-radius:14px; background:#fff; padding:12px; margin-bottom:10px }
.planeat-skin .saved-memo-item img{ width:100%; height:180px; object-fit:cover; border-radius:12px; border:1px solid var(--line) }
.planeat-skin .saved-memo-item h5{ margin:0 0 8px 0; font-size:16px }
.planeat-skin .item-actions{ position:absolute; top:10px; right:10px; display:flex; gap:6px }
.planeat-skin .icon-btn{ width:32px; height:32px; border-radius:10px; border:1px solid var(--line); background:#fff; display:grid; place-items:center; cursor:pointer; transition:transform .08s }
.planeat-skin .icon-btn:hover{ transform:translateY(-1px) }

.planeat-skin .todo-time-badge{ display:inline-flex; align-items:center; gap:4px; padding:2px 8px; border:1px solid var(--line); border-radius:999px; background:#fff; font-size:12px; font-weight:900 }
.planeat-skin #savedTodos{ list-style:none; padding:0; margin:0; display:flex; flex-direction:column; gap:8px }
.planeat-skin .todo-item{ border:1px solid var(--line); border-radius:12px; padding:10px; background:#fff; display:flex; gap:8px; align-items:flex-start }
.planeat-skin .todo-item.completed{ opacity:.55; text-decoration:line-through }

/* 인라인 에디터 + 썸네일 안전 규칙 (레이아웃 밀림 방지) */
.planeat-skin .inline-editor{ display:flex; flex-direction:column; gap:10px }
.planeat-skin .inline-row{ display:flex; gap:10px; align-items:center }
.planeat-skin .inline-row.grid-2{ display:grid; grid-template-columns:1fr 240px; gap:10px }
.planeat-skin .input,.planeat-skin .textarea,.planeat-skin .btn,
.planeat-skin input[type="date"],.planeat-skin input[type="time"]{
  border:1px solid var(--line); border-radius:10px; background:#fff; color:var(--text)
}
.planeat-skin .input{ height:36px; padding:0 10px }
.planeat-skin .textarea{ min-height:72px; padding:10px; resize:vertical }
.planeat-skin .btn{ padding:8px 12px; cursor:pointer; background:#fafafa }
.planeat-skin .btn.primary{ background:#000; color:#fff; border-color:#000 }

.planeat-skin .thumb-wrap{ position:relative !important; overflow:hidden !important; }
.planeat-skin .thumb{
  display:block !important; width:100% !important; height:180px !important;
  max-height:none !important; object-fit:cover !important; position:static !important; z-index:1 !important;
}
.planeat-skin .thumb-delete{ position:absolute; top:8px; right:8px; width:28px; height:28px; border-radius:50%; border:1px solid var(--line); background:#fff; cursor:pointer }

/* Day Timeline (옵션 영역—마크업 있으면 적용) */
.planeat-skin .dtl-wrap{ display:flex; flex-direction:column; gap:14px }
.planeat-skin .dtl-head{ display:flex; align-items:center; justify-content:space-between; padding:10px 12px; border:1px solid var(--line); border-radius:12px; background:#fff }
.planeat-skin .dtl-date{ font-weight:900; letter-spacing:-.02em }
.planeat-skin .dtl-body{ position:relative; border:1px solid var(--line); border-radius:14px; background:#fff; overflow:hidden }
.planeat-skin .dtl-grid{ display:grid; grid-template-columns:72px 1fr; position:relative }
.planeat-skin .dtl-hours{ display:flex; flex-direction:column; background:#faf8f6; border-right:1px solid var(--line) }
.planeat-skin .dtl-hour{ height:48px; display:flex; align-items:flex-start; justify-content:flex-end; padding:4px 8px; font-size:12px; color:var(--muted); border-top:1px dashed var(--grid) }
.planeat-skin .dtl-hour:first-child{ border-top:none }
.planeat-skin .dtl-slots{ position:relative; background:linear-gradient(180deg, rgba(0,0,0,0) 70%, rgba(0,0,0,.02) 100%) }
.planeat-skin .dtl-slot{ height:48px; border-top:1px dashed var(--grid); position:relative }
.planeat-skin .dtl-slot:first-child{ border-top:none }
.planeat-skin .now-line{ position:absolute; left:72px; right:0; height:2px; background:var(--now); box-shadow:0 0 0 1px rgba(37,99,235,.2); z-index:2 }
.planeat-skin .now-dot{ position:absolute; width:8px; height:8px; border-radius:50%; background:var(--now); left:68px; transform:translate(-50%,-50%); z-index:3 }
.planeat-skin .task{ position:absolute; left:10px; right:10px; min-height:34px; padding:6px 8px; border:1px solid var(--line); border-radius:12px; background:#f9fafb; display:flex; align-items:center; gap:8px; box-shadow:var(--soft) }
.planeat-skin .task .time{ font-size:12px; padding:2px 8px; border:1px solid var(--line); border-radius:999px; background:#fff; font-weight:900 }
.planeat-skin .task.completed{ opacity:.6; text-decoration:line-through }
.planeat-skin .task-non{ margin:12px; border:1px dashed var(--line); border-radius:12px; padding:10px 12px; background:#faf8f6 }
.planeat-skin .dtl-sec{ border:1px solid var(--line); border-radius:12px; background:#fff; padding:12px }
.planeat-skin .dtl-memo-list{ display:flex; flex-direction:column; gap:8px }
.planeat-skin .dtl-memo-item{ display:flex; gap:8px; align-items:center }
.planeat-skin .dtl-chip{ font-size:12px; padding:2px 8px; border:1px solid var(--line); border-radius:999px; background:#f8fafc; white-space:nowrap }
.planeat-skin .dtl-foot{ display:flex; justify-content:flex-end; gap:8px }

/* Quick Todo Bar (옵션) */
.planeat-skin #quickTodoBar{ display:block; margin-top:12px; background:#fff; border:1px solid var(--line); border-radius:14px; box-shadow:var(--soft); padding:12px }

/* Utils */
.planeat-skin .muted{ color:var(--muted) }

/* Responsive */
@media (max-width:960px){
  .planeat-skin .calendar-container{ margin:28px auto; padding:18px }
}
@media (max-width:760px){
  .planeat-skin #searchInput{ width:200px }
  .planeat-skin .inline-row.grid-2{ grid-template-columns:1fr }
}
@media (max-width:520px){
  .planeat-skin #searchInput{ width:160px }
  .planeat-skin #currentMonthYear{ font-size:22px }
  .planeat-skin .current-month{ min-height:110px; padding:10px }
}

/* ===== Day-cell 썸네일 강제 선명 모드 / 충돌 방지 (우선순위 ↑) ===== */
.planeat-skin .current-month{
  position: relative !important;
  overflow: hidden !important;
}
.planeat-skin .current-month .day-bg-underlay,
.planeat-skin .current-month .day-bg-img{
  position: absolute !important;
  inset: 0 !important;
  object-fit: cover !important;
  z-index: 0 !important;
  opacity: 1 !important;
  filter: none !important;
  mix-blend-mode: normal !important;
  pointer-events: none !important;
}
.planeat-skin .current-month .date-number,
.planeat-skin .current-month .day-list{
  position: relative !important;
  z-index: 2 !important;
}

/* 카드/에디터 썸네일 충돌 제거 */
.planeat-skin .saved-memo-item .thumb,
.planeat-skin .inline-editor .thumb,
.planeat-skin .thumb-wrap .thumb{
  display: block !important;
  width: 100% !important;
  height: 180px !important;
  max-height: none !important;
  object-fit: cover !important;
  position: static !important;
  z-index: 1 !important;
}
.planeat-skin .saved-memo-item img.thumb{
  border-radius: 12px !important;
  border: 1px solid var(--line) !important;
}

/* Month 뷰 높이 제한 해제(썸네일 잘림 방지) */
.planeat-skin #calendarGrid.is-month img.day-bg-underlay,
.planeat-skin #calendarGrid.is-month img.day-bg-img{
  max-height: none !important;
  height: 100% !important;
}
